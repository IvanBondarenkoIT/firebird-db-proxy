# üîí Security Guide

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firebird Database Proxy API.

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–æ–±–∑–æ—Ä-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [SQL Injection –∑–∞—â–∏—Ç–∞](#sql-injection-–∑–∞—â–∏—Ç–∞)
- [Rate Limiting](#rate-limiting)
- [HTTPS](#https)
- [Environment Variables](#environment-variables)
- [Best Practices](#best-practices)
- [–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–∞—É–¥–∏—Ç-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

## –û–±–∑–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã

1. **Network Level**
   - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP –≤ whitelist Firebird —Å–µ—Ä–≤–µ—Ä–∞
   - HTTPS —Ç–æ–ª—å–∫–æ –≤ production
   - CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

2. **Application Level**
   - Bearer Token –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏—è
   - Rate limiting
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

3. **Database Level**
   - READ-ONLY –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - Connection pooling

---

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### Bearer Token

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Bearer Token —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
python scripts/generate_token.py --length 64

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# Token 1: a1b2c3d4e5f6...64 —Å–∏–º–≤–æ–ª–∞
```

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–æ–∫–µ–Ω–∞–º

‚úÖ **–•–æ—Ä–æ—à–∏–µ —Ç–æ–∫–µ–Ω—ã:**
- –ú–∏–Ω–∏–º—É–º 32 –±–∞–π—Ç–∞ (64 hex —Å–∏–º–≤–æ–ª–∞)
- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å–ª—É—á–∞–π–Ω—ã–µ
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

‚ùå **–ü–ª–æ—Ö–∏–µ —Ç–æ–∫–µ–Ω—ã:**
```
my-token          # –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π
password123       # –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π
token-1           # –ù–µ—Å–ª—É—á–∞–π–Ω—ã–π
```

#### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

**–°–µ—Ä–≤–µ—Ä:**
```env
# .env —Ñ–∞–π–ª (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git!)
API_TOKENS=a1b2c3d4...,e5f6g7h8...
```

**–ö–ª–∏–µ–Ω—Ç:**
```python
# config.py –∏–ª–∏ environment variables
API_TOKEN = os.getenv("FIREBIRD_API_TOKEN")

# –ù–ï —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –≤ –∫–æ–¥–µ!
# API_TOKEN = "hardcoded-token"  # ‚ùå –ù–ò–ö–û–ì–î–ê!
```

#### –†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å —Ç–æ–∫–µ–Ω—ã:

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –≤ `API_TOKENS` (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
3. –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—ã –Ω–∞ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –∏–∑ `API_TOKENS`

```env
# –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω
API_TOKENS=old-token

# –ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–æ–±–∞ —Ä–∞–±–æ—Ç–∞—é—Ç)
API_TOKENS=old-token,new-token

# –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
API_TOKENS=new-token
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã

–†–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:

```env
API_TOKENS=mobile-app-token,web-app-token,analytics-token
```

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ú–æ–∂–Ω–æ –æ—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–æ–∫–µ–Ω–∞–º
- –†–∞–∑–Ω—ã–µ rate limits (–≤ –±—É–¥—É—â–µ–º)

---

## SQL Injection –∑–∞—â–∏—Ç–∞

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞

#### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

```python
# app/validators.py
FORBIDDEN_PATTERNS = [
    r'\b(INSERT|UPDATE|DELETE|DROP|ALTER|TRUNCATE|CREATE|GRANT|REVOKE)\b',
    r'\b(EXECUTE\s+BLOCK)\b',
    r'\b(EXECUTE\s+PROCEDURE)\b',
    r';.*;\s*',  # –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
]
```

#### 2. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ:**
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
query = "SELECT * FROM STORGRP WHERE ID = ?"
params = [user_input]
db.execute_query(query, params)
```

‚ùå **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ:**
```python
# –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫!
query = f"SELECT * FROM STORGRP WHERE ID = {user_input}"
db.execute_query(query)
```

#### 3. –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

SQL –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π:

```python
# –ü–æ–ø—ã—Ç–∫–∞ –æ–±—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
"SELECT * FROM STORGRP /* */ UPDATE /* hack */"
# ‚Üì –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Üì
"SELECT * FROM STORGRP  UPDATE  "
# ‚Üì –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º ‚úó
```

### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

‚úÖ **–¢–æ–ª—å–∫–æ READ-ONLY:**
- `SELECT`
- `WITH` (CTE)

‚ùå **–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:**
- DML: `INSERT`, `UPDATE`, `DELETE`
- DDL: `CREATE`, `DROP`, `ALTER`, `TRUNCATE`
- DCL: `GRANT`, `REVOKE`
- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã: `EXECUTE BLOCK`, `EXECUTE PROCEDURE`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `;`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
pytest tests/test_validators.py -v

# –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
# ‚úì SQL injection –ø–æ–ø—ã—Ç–∫–∏
# ‚úì –û–±—Ö–æ–¥ —á–µ—Ä–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
# ‚úì –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
# ‚úì –†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
# ‚úì –í—Å–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```

---

## Rate Limiting

–ó–∞—â–∏—Ç–∞ –æ—Ç DoS –∞—Ç–∞–∫ –∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤

```env
# .env
RATE_LIMIT_PER_MINUTE=60    # 60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –Ω–∞ IP
RATE_LIMIT_PER_HOUR=1000    # 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å –Ω–∞ IP
```

### –ú–µ—Ö–∞–Ω–∏–∑–º

- –õ–∏–º–∏—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ **IP –∞–¥—Ä–µ—Å—É**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `slowapi`
- Headers –≤ –æ—Ç–≤–µ—Ç–µ:
  ```http
  X-RateLimit-Limit: 60
  X-RateLimit-Remaining: 59
  X-RateLimit-Reset: 1634825400
  ```

### –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞

```json
{
  "error": "Rate limit exceeded: 60 per 1 minute"
}
```

Status: `429 Too Many Requests`

### Whitelist IP (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö IP –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å rate limiting:

```python
# app/main.py
from slowapi.util import get_remote_address

def get_remote_address_with_whitelist(request: Request):
    ip = request.client.host
    
    # Whitelist IP –∞–¥—Ä–µ—Å–∞ (–±–µ–∑ rate limiting)
    whitelist = ["10.0.0.1", "192.168.1.1"]
    
    if ip in whitelist:
        return None  # –û—Ç–∫–ª—é—á–∏—Ç—å rate limiting
    
    return ip
```

---

## HTTPS

### Production

‚ö†Ô∏è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production!**

Railway.com –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTPS:
```
https://your-app.railway.app
```

### SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

#### Railway/Render/Heroku
‚úÖ SSL –∏–∑ –∫–æ—Ä–æ–±–∫–∏ (Let's Encrypt)

#### VPS (—Ä—É—á–Ω–æ–π deployment)
```bash
# Certbot –¥–ª—è Let's Encrypt
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

### HSTS (HTTP Strict Transport Security)

–î–æ–±–∞–≤–∏—Ç—å –≤ Nginx –∫–æ–Ω—Ñ–∏–≥:

```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL

```bash
# SSL Labs
https://www.ssllabs.com/ssltest/analyze.html?d=your-domain.com

# –ò–ª–∏ —á–µ—Ä–µ–∑ curl
curl -I https://your-app.railway.app
```

---

## Environment Variables

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

**–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git:**
```env
DB_PASSWORD=masterkey
API_TOKENS=secret-token
```

### .gitignore

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.env` –≤ `.gitignore`:

```gitignore
# Environment variables
.env
.env.*
*.env
!.env.example
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

**Development:**
- –õ–æ–∫–∞–ª—å–Ω—ã–π `.env` —Ñ–∞–π–ª (–≤ `.gitignore`)
- Password manager –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

**Production:**
- Railway/Render/Heroku environment variables
- AWS Secrets Manager
- HashiCorp Vault

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Git –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞ —Å–µ–∫—Ä–µ—Ç—ã
git log -p | grep -i "password\|token\|secret"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å gitleaks
gitleaks detect --source . --verbose
```

---

## Best Practices

### 1. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

```env
# Firebird –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å READ-ONLY –ø—Ä–∞–≤–∞–º–∏
DB_USER=READONLY_USER  # –ù–µ SYSDBA!
```

–°–æ–∑–¥–∞—Ç—å READ-ONLY –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firebird:

```sql
CREATE USER readonly_user PASSWORD 'strong-password';
GRANT SELECT ON STORGRP TO readonly_user;
GRANT SELECT ON GOODS TO readonly_user;
-- –ò —Ç.–¥. –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
```

### 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# app/main.py
logger.info(
    f"‚Üí {request.method} {request.url.path} | "
    f"IP: {client_ip} | "
    f"Token: {token[:10]}..."  # –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10 —Å–∏–º–≤–æ–ª–æ–≤!
)
```

‚ùå **–ù–ò–ö–û–ì–î–ê –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:**
- –ü–æ–ª–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
- –ü–∞—Ä–æ–ª–∏ –ë–î
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤

### 3. CORS

```env
# Production - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã
ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com

# Development - –≤—Å–µ
ALLOWED_ORIGINS=*
```

### 4. –¢–∞–π–º–∞—É—Ç—ã

```env
DB_CONNECTION_TIMEOUT=10  # –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
DB_QUERY_TIMEOUT=30       # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞
```

–ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å—à–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–∞–∫–µ—Ç–æ–≤
pip list --outdated

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º!)
pip install --upgrade fastapi uvicorn fdb
```

### 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞:
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 401 (–±—Ä—É—Ç—Ñ–æ—Ä—Å —Ç–æ–∫–µ–Ω–æ–≤)
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 429 (DoS –ø–æ–ø—ã—Ç–∫–∏)
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL validation errors (–ø–æ–ø—ã—Ç–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–π)
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î

```python
# Webhook –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
if unauthorized_attempts > 10:
    send_alert_to_slack(
        "‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–∞—è –∞—Ç–∞–∫–∞ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ —Ç–æ–∫–µ–Ω–æ–≤!"
    )
```

---

## –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Checklist

- [ ] –°–∏–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (64+ —Å–∏–º–≤–æ–ª–æ–≤)
- [ ] –¢–æ–∫–µ–Ω—ã –Ω–µ –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- [ ] HTTPS –≤ production
- [ ] Rate limiting –≤–∫–ª—é—á–µ–Ω
- [ ] SQL –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] READ-ONLY –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
pytest tests/test_validators.py tests/test_auth.py -v
```

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ rate limiting

**–ï–∂–µ–º–µ—Å—è—á–Ω–æ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –†–µ–≤—å—é –ª–æ–≥–æ–≤

**–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ:**
- –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–µ–Ω—Ç–µ—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –£—Ç–µ—á–∫–∞ —Ç–æ–∫–µ–Ω–∞

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ** —É–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω –∏–∑ `API_TOKENS`
2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
3. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
5. –£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

### –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   ```bash
   # Railway
   railway logs
   
   # VPS
   sudo journalctl -u firebird-db-proxy | grep WARNING
   ```

2. –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP (–µ—Å–ª–∏ DoS):
   ```nginx
   # Nginx
   deny 1.2.3.4;
   ```

3. –£–≤–µ–ª–∏—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
   ```env
   LOG_LEVEL=DEBUG
   ```

### –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ë–î

1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –ë–î
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å whitelist IP –Ω–∞ Firebird —Å–µ—Ä–≤–µ—Ä–µ
3. –ê—É–¥–∏—Ç –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –ë–î
4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:

- **Email:** security@example.com
- **–ù–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å** –ø—É–±–ª–∏—á–Ω–æ –¥–æ —Ñ–∏–∫—Å–∞
- Responsible disclosure –ø–µ—Ä–∏–æ–¥: 90 –¥–Ω–µ–π

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-21

